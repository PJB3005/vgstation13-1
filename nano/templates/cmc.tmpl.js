NanoTemplate.preloadTemplate("cmc.tmpl", "<!-- \nTitle: Crew Monitor Textview\nUsed In File(s): \\code\\modules\\cmc\\crew.dm\n -->\n\n<html>\n    <head>\n        <title>Crew Monitor</title>\n    </head>\n    <body>\n            <div id=\"cmc_controls\">\n            {{:helper.link(\'\', \'refresh\', { \'toggle\' : 1 }, null, \'cmc_btn\', \'update_btn\')}}\n            {{:helper.link(\'\', \'image\', { \'holo\' : 1 }, null, \'cmc_btn\', \'holo_btn\')}}\n            {{for data.levels}}\n                {{:helper.link(value, \'\', { \'setZ\' : value }, null, \'cmc_btn\', value)}}\n            {{/for}}\n            </div>\n            <div id=\"cmc_main\"><table align=\'center\' id=\'contents\'>Loading...</table></div>\n        <script>\n        var prevlevel = 1;\n\n        function populateTable(entries_string){\n            var entries = $.parseJSON(entries_string);\n            var string = \"<tr><th><u>Name</u></th><th><u>Vitals</u></th><th><u>Position</u></th></tr>\";\n            for(var i in entries){\n                entry = entries[i];\n                string += \"<tr><td><span class=\'name \"+entry.role+\"\'>\"+entry.name+\"</span> (\"+entry.job+\")</td>\";\n                string += \"<td><img src=\'cmc_\"+entry.icon+\".png\' height=\'11\' width=\'11\'/>\";\n                if(entry.damage){\n                    string +=  \"(<span class=\'oxygen\'>\"+entry.damage.oxygen+\"</span>/<span class=\'toxin\'>\"+entry.damage.toxin+\"</span>/<span class=\'fire\'>\"+entry.damage.fire+\"</span>/<span class=\'brute\'>\"+entry.damage.brute+\"</span>)\";\n                } else {\n                    string += \"Not Available\";\n                }\n                string += \"</td><td>\";\n                if(entry.see){\n                    string += entry.area+\" (\"+entry.see.x+\",\"+entry.see.y+\")\";\n                } else {\n                    string += \"Not Available\";\n                }\n                string += \"</td></tr>\";\n            }\n\n            $(\"#contents\").html(string);\n        }\n\n        function noData(){\n            $(\"#contents\").html(\"<tr><td>No data currently available</td></tr>\");\n        }\n\n        function toggleUpdatebtn(num){\n            if(num == 1){\n                $(\"#update_btn\").css(\'background-color\', \'green\');\n            }else{\n                $(\"#update_btn\").css(\'background-color\', \'red\');\n            }\n        }\n\n        function messageReceived(){\n            $(\'.linkActive\').stopTime(\'linkPending\');\n            $(\'.linkActive\').removeClass(\'linkPending\');\n            $(\'.buttonActive\').stopTime(\'linkPending\');\n            $(\'.buttonActive\').removeClass(\'linkPending\');\n        }\n\n        function levelSet(level){\n            if(prevlevel != level){\n                var prevbtn = $(\"#\"+prevlevel);\n                prevbtn.removeClass(\"linkOff\");\n            }\n            var btn = $(\"#\"+level);\n            btn.addClass(\"linkOff\");\n            prevlevel = level;\n        }\n\n        levelSet(prevlevel);\n        toggleUpdatebtn({{:data.update}});\n        </script>\n    </body>\n</html>");